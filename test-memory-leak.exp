#\!/usr/bin/expect -f

set timeout 30
log_user 1

# JSONデータを用意
spawn sh -c {echo '{"a": 1, "b": 2}' | node dist/index.js --verbose 2>&1}

# REPLプロンプトを待つ
expect ">"

# 大量の文字を入力してリアルタイム評価を連続実行
for {set i 0} {$i < 15} {incr i} {
    send "$.a"
    sleep 0.1
    send "\x08"  ;# バックスペース
    send "\x08"
    send "\x08"
    send "\x08"
    sleep 0.1
}

# 終了
send "\x03"
expect eof
EOF < /dev/null