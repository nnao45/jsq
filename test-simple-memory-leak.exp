#!/usr/bin/expect -f

set timeout 30
log_user 1

# JSONデータを用意
spawn sh -c {echo '{"a": 1, "b": 2}' | node dist/index.js --verbose 2>&1}

# REPLプロンプトを待つ
expect ">"

# 30回の入力と削除を実行
for {set i 0} {$i < 30} {incr i} {
    send "$.a"
    sleep 0.05
    send "\x15"  ;# Ctrl+U (delete all)
    sleep 0.05
}

# 終了
send "\x03"
expect eof