# JSQ REPL E2E Tests

このディレクトリには、JSQのREPLモードのE2Eテストが含まれています。

## テストファイル

### repl-realtime-eval.exp
リアルタイム評価機能のE2Eテスト。以下を検証します：

1. **1文字ごとの評価**: `$.test`と入力する際、各文字（`$`, `.`, `t`, `e`, `s`, `t`）を入力するたびに評価結果が更新される
2. **バックスペース対応**: バックスペースで文字を削除した時も即座に再評価される
3. **配列アクセス**: `$.items[0]`のような配列インデックスアクセス時の評価
4. **複雑な式**: `filter`や`map`などの関数を使った式の評価
5. **Deleteキー対応**: カーソル移動してDeleteキーで削除した場合の再評価
6. **高速タイピング**: 素早く文字を入力しても追従できるか

## テスト実行方法

```bash
# ビルドとテスト実行
./test-repl-realtime.sh

# expectスクリプトを直接実行
expect src/e2e/repl-realtime-eval.exp
```

## テストの仕組み

Expectスクリプトは以下のように動作します：

1. JSQをREPLモードで起動
2. キーボード入力をシミュレート
3. 画面出力を監視して期待する結果が表示されるか確認
4. リアルタイム評価の結果は `→ 結果` の形式で表示される

## 期待される出力例

```
> $.test
→ "data"
```

1文字ずつ入力すると：
- `$` → （表示なし - 無効な式）
- `$.` → `→ {"test":"data","value":42}`
- `$.t` → `→ undefined`
- `$.te` → `→ undefined` 
- `$.tes` → `→ undefined`
- `$.test` → `→ "data"`