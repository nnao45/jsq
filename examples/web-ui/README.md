# JSQ Web Playground

ãƒ–ãƒ©ã‚¦ã‚¶ã§JSQã‚’ä½“é¨“ã§ãã‚‹Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚2ã¤ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒã‚ã‚Šã¾ã™ï¼š

1. **ç°¡æ˜“ç‰ˆ** (`index.html`) - QuickJS WASMã‚’ç›´æ¥ä½¿ç”¨ã—ãŸã‚·ãƒ³ãƒ—ãƒ«ãªå®Ÿè£…
2. **æœ¬æ ¼ç‰ˆ** (`index-webpack.html`) - å®Ÿéš›ã®JSQã‚³ãƒ¼ãƒ‰ã‚’Webpackã§ãƒãƒ³ãƒ‰ãƒ«ã—ãŸå®Œå…¨ç‰ˆ

## æ©Ÿèƒ½

- ğŸš€ **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ JSONå‡¦ç†**: JSONãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦JavaScriptå¼ã‚’å®Ÿè¡Œ
- ğŸ’¡ **ã‚¹ãƒãƒ¼ãƒˆãƒ‰ãƒ«è¨˜æ³•**: `$`ã‚’ä½¿ã£ãŸç›´æ„Ÿçš„ãªãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹
- ğŸ”§ **Lodashã‚µãƒãƒ¼ãƒˆ**: æœ¬ç‰©ã®Lodashé–¢æ•°ã‚’ä½¿ç”¨
- ğŸ“ **ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›**: `console.log()`ã§ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã‚’è¡¨ç¤º
- ğŸ¨ **ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ãƒã‚¤ãƒ©ã‚¤ãƒˆ**: çµæœã‚’ãã‚Œã„ã«è¡¨ç¤º
- âš™ï¸ **å¼å¤‰æ›è¡¨ç¤º**: JSQãŒã©ã®ã‚ˆã†ã«å¼ã‚’å¤‰æ›ã™ã‚‹ã‹ã‚’ç¢ºèªå¯èƒ½

## ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### ç°¡æ˜“ç‰ˆï¼ˆã™ãã«è©¦ã›ã‚‹ï¼‰

```bash
cd examples/web-ui
python -m http.server 8000
# ãƒ–ãƒ©ã‚¦ã‚¶ã§ http://localhost:8000 ã‚’é–‹ã
```

### æœ¬æ ¼ç‰ˆï¼ˆå®Ÿéš›ã®JSQã‚³ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ï¼‰

```bash
cd examples/web-ui

# ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install

# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ï¼ˆè‡ªå‹•ãƒªãƒ­ãƒ¼ãƒ‰ä»˜ãï¼‰
npm run dev
# ãƒ–ãƒ©ã‚¦ã‚¶ã§ http://localhost:9000 ãŒè‡ªå‹•ã§é–‹ã

# ã¾ãŸã¯æœ¬ç•ªãƒ“ãƒ«ãƒ‰
npm run build
# distãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ãƒ“ãƒ«ãƒ‰ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã‚‹
```

## ä½¿ç”¨ä¾‹

### åŸºæœ¬çš„ãªä½¿ã„æ–¹

```javascript
// å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åå‰ã‚’å–å¾—ï¼ˆSmartDollarè¨˜æ³•ï¼‰
$.users.name

// å¹´é½¢ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
$.users.filter(u => u.age > 25)

// éƒ½å¸‚ã§ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ï¼ˆãƒ‘ã‚¤ãƒ—æ¼”ç®—å­ï¼‰
$.users | _.groupBy('city')
```

### é«˜åº¦ãªä½¿ã„æ–¹

```javascript
// è¤‡é›‘ãªå¤‰æ›
$.users
  .filter(u => u.active)
  .map(u => ({
    ...u,
    ageGroup: u.age < 30 ? 'young' : 'adult'
  }))

// é›†è¨ˆã¨ãƒã‚§ãƒ¼ãƒ³å‡¦ç†
$.products
  .filter(p => p.inStock)
  | _.sortBy('price')
  | _.take(5)

// ãƒ‡ãƒãƒƒã‚°å‡ºåŠ›ä»˜ã
(() => {
  console.log('Total users:', $.users.length);
  const activeUsers = $.users.filter(u => u.active);
  console.log('Active users:', activeUsers.length);
  return activeUsers;
})()

// ãƒã‚¹ãƒˆã—ãŸãƒ‡ãƒ¼ã‚¿ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹
$.stats.metrics.revenue
```

## æŠ€è¡“è©³ç´°

### ç°¡æ˜“ç‰ˆ
- **QuickJS WASM**: CDNã‹ã‚‰ç›´æ¥èª­ã¿è¾¼ã¿
- **æ‰‹å‹•å®Ÿè£…**: SmartDollarã¨Lodashã®ç°¡æ˜“å®Ÿè£…
- **è»½é‡**: è¿½åŠ ã®ä¾å­˜é–¢ä¿‚ãªã—

### æœ¬æ ¼ç‰ˆ
- **å®Ÿéš›ã®JSQã‚³ãƒ¼ãƒ‰**: `src/core`ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½¿ç”¨
- **å®Œå…¨ãªæ©Ÿèƒ½**: Node.jsç‰ˆã¨åŒã˜è©•ä¾¡ã‚¨ãƒ³ã‚¸ãƒ³
- **Webpack**: TypeScriptã®ãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ«ã¨ãƒãƒ³ãƒ‰ãƒ«
- **QuickJSçµ±åˆ**: æœ¬ç‰©ã®VMã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹å®Ÿè£…

## ãƒ“ãƒ«ãƒ‰è¨­å®š

### Webpackè¨­å®šã®ä¸»ãªå†…å®¹
```javascript
{
  // Node.jså›ºæœ‰ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¹ã‚¿ãƒ–åŒ–
  resolve: {
    fallback: {
      "fs": false,
      "path": false,
      "stream": false
    }
  },
  // QuickJS WASMã‚µãƒãƒ¼ãƒˆ
  experiments: {
    asyncWebAssembly: true
  }
}
```

### TypeScriptè¨­å®š
- ãƒ‘ã‚¹ã‚¨ã‚¤ãƒªã‚¢ã‚¹: `@/` â†’ `../../src/`
- ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ: ES2020
- DOMå‹å®šç¾©ã‚’å«ã‚€

## APIãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

### ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
```javascript
// JSQã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ï¼ˆè‡ªå‹•åˆæœŸåŒ–ï¼‰
window.jsq

// JSQã‚¯ãƒ©ã‚¹ï¼ˆæ‰‹å‹•åˆæœŸåŒ–ç”¨ï¼‰
window.JSQ
```

### ãƒ¡ã‚½ãƒƒãƒ‰
```javascript
// åˆæœŸåŒ–
await jsq.initialize();

// å¼ã®è©•ä¾¡
const result = await jsq.evaluate(expression, data, options);

// å¼ã®å¤‰æ›ï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰
const transformed = jsq.transform(expression);
```

## ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

### æ–°ã—ã„Lodashé–¢æ•°ã‚’è¿½åŠ 
```javascript
// browser-entry.tsã¾ãŸã¯app.jsã‚’ç·¨é›†
_.chunk = function(array, size) {
  const result = [];
  for (let i = 0; i < array.length; i += size) {
    result.push(array.slice(i, i + size));
  }
  return result;
};
```

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã€ŒLifetime not aliveã€ã‚¨ãƒ©ãƒ¼
QuickJSã®ãƒãƒ³ãƒ‰ãƒ«ç®¡ç†ã®å•é¡Œã§ã™ã€‚VMã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’é©åˆ‡ã«dispose()ã—ã¦ãã ã•ã„ã€‚

### åˆæœŸåŒ–ã«å¤±æ•—
- ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ã‚¨ãƒ©ãƒ¼ã‚’ç¢ºèª
- CORSãƒãƒªã‚·ãƒ¼ã«æ³¨æ„ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ã‚µãƒ¼ãƒãƒ¼ãŒå¿…è¦ï¼‰
- WebAssemblyãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ãƒ–ãƒ©ã‚¦ã‚¶ã‚’ä½¿ç”¨

### ãƒ¡ãƒ¢ãƒªä¸è¶³
- ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚ºã‚’å°ã•ãã™ã‚‹
- ãƒ¡ãƒ¢ãƒªãƒªãƒŸãƒƒãƒˆã‚’å¢—ã‚„ã™ï¼ˆoptions.memoryLimitï¼‰

## åˆ¶é™äº‹é …

- ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚¢ã‚¯ã‚»ã‚¹ãªã—ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ã®åˆ¶é™ï¼‰
- ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°ãªã—
- ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å‡¦ç†ã¯é™å®šçš„
- ä¸€éƒ¨ã®Node.jså›ºæœ‰æ©Ÿèƒ½ã¯åˆ©ç”¨ä¸å¯

## ä»Šå¾Œã®æ‹¡å¼µäºˆå®š

- [ ] Web Workersã§ã®ä¸¦åˆ—å‡¦ç†
- [ ] IndexedDBã§ã®ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–
- [ ] PWAå¯¾å¿œï¼ˆã‚ªãƒ•ãƒ©ã‚¤ãƒ³å‹•ä½œï¼‰
- [ ] ã‚ˆã‚Šå¤šãã®Lodashé–¢æ•°ã®ã‚µãƒãƒ¼ãƒˆ
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®è¡¨ç¤º

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

JSQæœ¬ä½“ã¨åŒã˜ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã«å¾“ã„ã¾ã™ã€‚